---
title: "Introduction to theme61"
output: rmarkdown::html_vignette
description: Some example code showing how to use `theme61` with `ggplot2` graphs.
vignette: >
  %\VignetteIndexEntry{Introduction to theme61}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r echo = FALSE, message = FALSE, warning = FALSE}
library(ggplot2)
library(data.table)
devtools::load_all()

knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

`theme61` is an extension to `ggplot2`. It is made up of a custom theme and functions that change the appearance of a standard `ggplot2` graph.

You should read this article and the [Graph standards](graph-standards.html) article to help you understand how to create graphs following the e61 graph standards. 

This article provides some examples to help you figure out what elements you can change. The function documentation provides comprehensive information on the full customisability of the package.

## The colour palette

```{r colour-palette-chart, echo = FALSE}
source("colour-palette.R", print.eval = TRUE)
```

## Correct workflow

When making graphs, you should follow the below workflow. 

Save your graph using `save_e61()`. Do **not** use the Export button in the Plots tab or `ggsave()`.

Start by creating a graph using the 'normal' stuff: `ggplot(data, aes(x, y)) + geom_blah()`

Then:
- (optional) Use `theme_e61()` if you want to add a legend, or change its position. Other aspects of `theme_e61()` are now added by default. 
- (optional) Format the x and y axes scales: `scale_y_continuous_e61()`, `scale_x_continuous_e61()`. Your y-axis will be automatically scaled when you save your chart using `save_e61()` but if you do not like the automatic scaling then you can always scale you axes manually.
- Add plot labelling: `mplot_label()` or `plot_label()`
- Add titles, axes labels, footnotes and sources: `labs_e61(title = "Title", footnotes = "Footnotes", sources = c("Source 1", "Source 2"))`
- Save the graph: `save_e61()`. If you want to save a multi-panel, this is now done within `save_e61()` using the same argument as the old `mpanel()` function.

The [Graph standards](graph-standards.html) article sets out this workflow in greater detail.

## Graph examples

### Scatter graph

```{r}

# Set up data
mtcars2 <- within(mtcars, {
  vs <- factor(vs, labels = c("V-shaped", "Straight"))
  am <- factor(am, labels = c("Automatic", "Manual"))
  cyl  <- factor(cyl)
  gear <- factor(gear)
})

# Graph
fig1 <- ggplot(mtcars2, aes(x = wt, y = mpg, colour = gear)) +
  geom_point() +
  mplot_label(
    label = c("3", "4", "5"),
    x = c(4, 2.7, 2.5),
    y = c(23, 35, 15)
  ) +
  labs_e61(
    title = "Heavier cars are less fuel efficient",
    subtitle = "Data from 1973-74",
    sources = "1974 Motor Trend US magazine.",
    x = "Weight (1000 lbs)",
    y = "mpg",
    colour = "Gears"
  )

save_e61(here::here("man/figures/fig-1.svg"), fig1)

knitr::include_graphics(here::here("man/figures/fig-1.svg"))

```

### Faceted scatter graph

```{r}
fig2 <- ggplot(mtcars2, aes(x = wt, y = mpg, colour = gear)) +
  facet_grid(vs ~ am) +
  geom_point() +
  mplot_label(
    label = c("3", "4", "5"),
    x = c(4, 2.7, 2.5),
    y = c(23, 35, 15)
  ) +
  labs_e61(
    title = "Heavier cars are less fuel efficient",
    subtitle = "Data from 1973-74",
    sources = "1974 Motor Trend US magazine.",
    x = "Weight (1000 lbs)",
    y = "mpg",
    colour = "Gears"
  ) +
  theme_e61(legend = "bottom", legend_title = TRUE)

save_e61(here::here("man/figures/fig-2.svg"), fig2)

knitr::include_graphics(here::here("man/figures/fig-2.svg"))


```

### Density graph - with the e61 logo added

```{r}
fig3 <- ggplot(mpg, aes(x = cty, fill = factor(cyl))) + 
  geom_density(linetype = "blank", alpha = 0.8) +
  labs_e61(
    title = "Distribution of car city mileage",
    subtitle = "In miles per gallon, by number of cylinders",
    sources = "mpg dataset",
    x = NULL,
    y = "dens",
    fill = "No. cylinders"
  ) +
  mplot_label(label = c("3 cyl", "5 cyl", "6 cyl", "8 cyl"),
              x = c(25, 24, 16, 12),
              y = c(0.1, 0.35, 0.25, 0.25)) +
  add_e61_logo()

save_e61(here::here("man/figures/fig-3.svg"), fig3)

knitr::include_graphics(here::here("man/figures/fig-3.svg"))

```

### Line graph - and an example of using `scale_x_date()`

```{r}
df <- economics_long[economics_long$variable %in% c("psavert", "uempmed"), ]
df <- df[year(df$date) %in% c(1967:1981), ]

# plot
fig4 <- ggplot(df, aes(x = date, y = value, colour = variable)) +
  geom_line(size = 1) +
  mplot_label(
    label = c("Market returns", "Unemployment"),
    x = c(as.Date("1969-01-01"), as.Date("1973-01-01")),
    y = c(17, 3),
    size = 3
  ) +
  labs_e61(
    title = "Time series of returns percentage*",
    subtitle = "Drawn from long data format",
    footnotes = "Some pointless footnote",
    sources = "Economics",
    x = NULL, 
    y = "%"
  ) + 
  scale_x_date(date_breaks = "3 years", date_labels = "%Y") +
  add_e61_logo()

save_e61(here::here("man/figures/fig-4.svg"), fig4)

knitr::include_graphics(here::here("man/figures/fig-4.svg"))


```

### Column graph

```{r}
col_data <- head(mtcars2, 8)
col_data$names <- rownames(col_data)
col_data$index <- 1:nrow(col_data)

fig5 <- ggplot(col_data, aes(x = index, y = hp, fill = hp)) +
  geom_col() +
  labs_e61(
    title = "Frivolous filled column chart", 
    subtitle = "For the purpose of showing off the continuous colour palette",
    sources = c("e61 Institute", "Another source"),
    x = NULL, y = "hp") +
  theme_e61(legend = "bottom")

save_e61(here::here("man/figures/fig-5.svg"), fig5)

knitr::include_graphics(here::here("man/figures/fig-5.svg"))

```

### Horizontal bar chart

```{r}
col_data <- head(mtcars2, 8)
col_data$names <- rownames(col_data)
col_data$index <- 1:nrow(col_data)

fig6 <- ggplot(col_data, aes(x = factor(index), y = hp, fill = hp)) +
  geom_col() +
  coord_flip() +
  theme_e61(legend = "bottom") +
  labs_e61(
    title = "Frivolous filled horizontal bar chart", 
    subtitle = "For the purpose of showing off the continuous colour palette",
    sources = c("e61 Institute", "Another source"),
    x = NULL, y = "hp")
  
save_e61(here::here("man/figures/fig-6.svg"), fig6)

knitr::include_graphics(here::here("man/figures/fig-6.svg"))

```

